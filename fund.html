<html>
<head>
    <title>Add Operation</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>
     <link rel="stylesheet" href="./fund.css">
</head>
<body>
    <div class="header">
        <img alt="GSRA BANKS Logo" height="50" src="./images/logo.jpg" width="100"/>
        <div class="nav-links">
         <a href="#">
          What's New
         </a>
         <a href="#">
          About GSRA
         </a>
         <a href="#">
          Registration Forms
         </a>
         <a class="language" href="#">
          Language
         </a>
         <a class="logout" href="./index.html">
          <i class="fas fa-power-off">
          </i>
          LOGOUT
         </a>
        </div>
       </div>
       
    
    <div class="tabs">
        <a href="./sb.html" class="tab">HOME</a>
        <a href="./fund.html" class="tab active">Transfer</a>
        <a href="./ac.html" class="tab">Account info</a>
        
    </div>
    <div class="container">
        <div class="form-container" id="transferForm">
            <div class="form-header">Payment</div>
            <div class="form-body">
                <input type="text"    id="toUsername" required placeholder="Recipient UserName" >
                <input type="number"  id="Account" placeholder="Account Number" required>
                <input type="number"  id="amount" placeholder="Amount" required>
                <button type="submit">Transfer</button>
            </div>
        </div>
    </div>
    <script>
    document.getElementById('transferForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        const token = localStorage.getItem('token'); // Retrieve saved token
        const toUsername = document.getElementById('toUsername').value;
        const amount = document.getElementById('amount').value;
      
        try {
          const response = await fetch('http://localhost:5500/api/transactions/transfer', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
              Authorization: `Bearer ${token}`,
            },
            body: JSON.stringify({ toUsername, amount }),
          });
      
          if (response.ok) {
            alert('Transfer successful!');
          } else {
            const error = await response.json();
            alert(`Error: ${error.error}`);
          }
        } catch (err) {
          console.error(err);
          alert('Transfer failed.');
        }
      });
    </script>
</body>
</html>